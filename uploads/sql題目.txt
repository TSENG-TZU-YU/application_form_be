1. table: auth_users 欄位 name 做模糊化
用到概念：casewhen ,substring
2. table: auth_users 欄位 email 歸類

SELECT SUBSTRING(email,INSTR(email,'@')) AS emailType, COUNT(SUBSTRING(email,INSTR(email,'@'))) AS total
FROM auth_users
GROUP BY emailType
ORDER BY total DESC
LIMIT 9

用到概念：group by,substring,top,order by
3. table: auth_users,yx_order,yx_order_detail,yx_store_goods
題目
3-1
10月份 有幾筆訂單，總銷售金額

SELECT COUNT(*) AS orderCount , SUM(goods_actual_payment) AS total 
FROM yx_order 
WHERE status in (10,20,40) 
AND (created_at BETWEEN 20221001 AND 20221031)

3-2
10月份 熱賣商品TOP5&銷售數量

SELECT SUM(d.quantity) AS quantity, g.title
FROM 
yx_order_detail d
JOIN yx_store_goods g ON d.goods_id = g.id
JOIN yx_order o ON d.main_order_no = o.p_order_no
WHERE (d.created_at BETWEEN 20221001 AND 20221031) 
AND o.status in (10,20,40) 
GROUP BY d.goods_id 
ORDER BY quantity DESC
LIMIT 5 

3-3
10月份 銷售金額最高前三名會員

SELECT u.name, SUM(goods_actual_payment) AS total 
FROM 
yx_order o
JOIN auth_users u ON o.user_id = u.id
WHERE o.status in (10,20,40) 
AND (o.created_at BETWEEN 20221001 AND 20221031)
GROUP BY o.user_id
ORDER BY total DESC 
LIMIT 3

注意狀態要在：
yx_order  status  in (10,20,40) ，10已支付、待出貨 20已出貨 40已完成

4. table: yx_order,yx_order_detail,yx_store_goods
找出產品名稱有 "衛生" 相關產品，並計算出10月份個產品數量，單價及總銷售金額

SELECT SUM(quantity) AS quantity, g.selling_price AS price , SUM(quantity)*g.selling_price AS total , 
FROM 
yx_order_detail d
JOIN yx_store_goods g ON d.goods_id = g.id
WHERE 
(d.created_at BETWEEN 20221001 AND 20221031) 
AND g.title LIKE '%衛生%'
GROUP BY d.goods_id 

用到概念：group by,sum,like

5. table: auth_users 欄位birth ,sex
找出各年齡 男 女 未知  的數量

欄位birth 請排除
1970-01-01
0000-00-00
及其他 可能是錯誤的資料
sex = 0 未知
sex = 1 男
sex = 2 女
請秀出TABLE
年齡區間  男  女  未知
19 歲以下 10  5    7
20~29     10  5    7
30~39     10  5    7
40~49     10  5    7
50~59     10  5    7
60 歲以上 10  5    7

6. table: GS_ticket_info 
票券的截止日期 Date_End YYYYMMDD 轉換成民國年月日 YYYMMDD
SELECT REPLACE(Date_End-19110000,',','') FROM GS_ticket_info